[gd_scene load_steps=9 format=3 uid="uid://b6sjienfug7r"]

[ext_resource type="Script" uid="uid://c1aqmqlfaqv2x" path="res://get_off_bus.gd" id="1_c3wlw"]
[ext_resource type="Texture2D" uid="uid://ci5ef1cau4niu" path="res://icon.svg" id="2_0e48y"]
[ext_resource type="Script" uid="uid://ewoigt3f7kqv" path="res://doortimer.gd" id="2_0hol4"]
[ext_resource type="Script" uid="uid://cfpf2m0i0ki58" path="res://bus.gd" id="4_0hol4"]
[ext_resource type="Texture2D" uid="uid://dhshflediw7je" path="res://assets/blue.png" id="4_q6r6c"]

[sub_resource type="Animation" id="Animation_q6r6c"]
resource_name = "player_out_of_bus"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Player:position")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector2(960, 500), Vector2(960, 750)]
}

[sub_resource type="Animation" id="Animation_kdubu"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Player:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(960, 500)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_d21ai"]
_data = {
&"RESET": SubResource("Animation_kdubu"),
&"player_out_of_bus": SubResource("Animation_q6r6c")
}

[node name="Node2D" type="Node2D"]

[node name="Button" type="Button" parent="." node_paths=PackedStringArray("node", "getOffBusAnim")]
offset_left = 1311.0
offset_top = 143.0
offset_right = 1782.0
offset_bottom = 293.0
text = "get off the bus!!"
script = ExtResource("1_c3wlw")
node = NodePath("../Player")
getOffBusAnim = NodePath("../AnimationPlayer")

[node name="TimerToDoorOpen" type="Timer" parent="." node_paths=PackedStringArray("slider")]
wait_time = 1.047
one_shot = true
script = ExtResource("2_0hol4")
slider = NodePath("HSlider")

[node name="MissedText" type="Label" parent="TimerToDoorOpen"]
visible = false
offset_left = 1338.0
offset_top = 376.0
offset_right = 1756.0
offset_bottom = 456.0
theme_override_font_sizes/font_size = 56
text = "Missed!"
horizontal_alignment = 1

[node name="HSlider" type="HSlider" parent="TimerToDoorOpen"]
offset_left = 1258.0
offset_top = 305.0
offset_right = 1828.0
offset_bottom = 370.0
step = 0.01
editable = false

[node name="Player" type="Sprite2D" parent="."]
position = Vector2(960, 500)
texture = ExtResource("2_0e48y")

[node name="Bus" type="Sprite2D" parent="."]
z_index = -1
position = Vector2(955, 418)
texture = ExtResource("4_q6r6c")
script = ExtResource("4_0hol4")
crowdedness = 0.07

[node name="TimerToStop" type="Timer" parent="."]
wait_time = 3.0
one_shot = true
autostart = true

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
&"": SubResource("AnimationLibrary_d21ai")
}

[connection signal="buttonPress" from="Button" to="TimerToDoorOpen" method="stop"]
[connection signal="timeout" from="TimerToDoorOpen" to="Button" method="_on_timeout"]
[connection signal="timeout" from="TimerToDoorOpen" to="TimerToDoorOpen/MissedText" method="set_visible" binds= [true]]
[connection signal="stop" from="Bus" to="TimerToDoorOpen" method="_on_stop"]
[connection signal="timeout" from="TimerToStop" to="Button" method="_on_stop"]
[connection signal="timeout" from="TimerToStop" to="Bus" method="_stop"]
