[gd_scene load_steps=11 format=3 uid="uid://b6sjienfug7r"]

[ext_resource type="Script" uid="uid://bo7rdnbe33rum" path="res://get_off_bus_minigame.gd" id="1_u8ire"]
[ext_resource type="Script" uid="uid://ewoigt3f7kqv" path="res://doortimer.gd" id="2_l08dc"]
[ext_resource type="Texture2D" uid="uid://ci5ef1cau4niu" path="res://icon.svg" id="3_d0q14"]
[ext_resource type="Texture2D" uid="uid://cu4ry7pb31pnn" path="res://assets/pink.png" id="4_l08dc"]
[ext_resource type="Texture2D" uid="uid://dhshflediw7je" path="res://assets/blue.png" id="4_pqf1f"]
[ext_resource type="Script" uid="uid://cfpf2m0i0ki58" path="res://bus.gd" id="5_2qay8"]

[sub_resource type="Animation" id="Animation_kdubu"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Player:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(960, 500)]
}

[sub_resource type="Animation" id="Animation_q6r6c"]
resource_name = "player_out_of_bus"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Player:position")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector2(960, 500), Vector2(960, 750)]
}

[sub_resource type="Animation" id="Animation_d0q14"]
resource_name = "thanks"

[sub_resource type="AnimationLibrary" id="AnimationLibrary_d21ai"]
_data = {
&"RESET": SubResource("Animation_kdubu"),
&"player_out_of_bus": SubResource("Animation_q6r6c"),
&"thanks": SubResource("Animation_d0q14")
}

[node name="get_off_bus_minigame" type="Node2D"]
script = ExtResource("1_u8ire")

[node name="Button" type="Button" parent="." node_paths=PackedStringArray("node", "getOffBusAnim", "thanksBubble")]
offset_left = 1311.0
offset_top = 143.0
offset_right = 1782.0
offset_bottom = 293.0
text = "get off the bus!!"
script = ExtResource("1_u8ire")
node = NodePath("../Player")
getOffBusAnim = NodePath("../AnimationPlayer")
thanksBubble = NodePath("../Player/Thanks Bubble")

[node name="Timer" type="Timer" parent="Button"]
wait_time = 0.25
one_shot = true

[node name="TimerToDoorOpen" type="Timer" parent="." node_paths=PackedStringArray("slider")]
wait_time = 1.047
one_shot = true
script = ExtResource("2_l08dc")
slider = NodePath("HSlider")

[node name="MissedText" type="Label" parent="TimerToDoorOpen"]
visible = false
offset_left = 1338.0
offset_top = 376.0
offset_right = 1756.0
offset_bottom = 456.0
theme_override_font_sizes/font_size = 56
text = "Missed!"
horizontal_alignment = 1

[node name="HSlider" type="HSlider" parent="TimerToDoorOpen"]
offset_left = 1258.0
offset_top = 305.0
offset_right = 1828.0
offset_bottom = 370.0
step = 0.01
editable = false

[node name="Player" type="Sprite2D" parent="."]
position = Vector2(960, 500)
scale = Vector2(0.4, 0.4)
texture = ExtResource("3_u8ire")

[node name="Thanks Bubble" type="Sprite2D" parent="Player"]
visible = false
position = Vector2(50, -50)
scale = Vector2(0.34, 0.34)
texture = ExtResource("4_l08dc")

[node name="Label" type="Label" parent="Player/Thanks Bubble"]
offset_left = -200.0
offset_top = -100.0
offset_right = 144.0
offset_bottom = 10.0
theme_override_font_sizes/font_size = 80
text = "Thanks!!!"

[node name="Bus" type="Sprite2D" parent="."]
z_index = -2
position = Vector2(955, 418)
texture = ExtResource("4_pqf1f")
script = ExtResource("5_2qay8")
crowdedness = 0.07

[node name="TimerToStop" type="Timer" parent="."]
wait_time = 3.0
one_shot = true
autostart = true

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
&"": SubResource("AnimationLibrary_d21ai")
}

[connection signal="pressed" from="Button" to="." method="_on_button_pressed"]
[connection signal="timeout" from="TimerToDoorOpen" to="." method="_on_timer_to_door_open_timeout"]
[connection signal="timeout" from="TimerToDoorOpen" to="Button" method="_on_timeout"]
[connection signal="timeout" from="TimerToDoorOpen" to="TimerToDoorOpen/MissedText" method="set_visible" binds= [true]]
[connection signal="stop" from="Bus" to="TimerToDoorOpen" method="_on_stop"]
[connection signal="timeout" from="TimerToStop" to="." method="_on_timer_to_stop_timeout"]
[connection signal="timeout" from="TimerToStop" to="Button" method="_on_stop"]
[connection signal="timeout" from="TimerToStop" to="Bus" method="_stop"]
